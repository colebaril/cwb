% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/safe_read_data.R
\name{safe_read_data}
\alias{safe_read_data}
\title{Safely read a data file with consistent output}
\usage{
safe_read_data(
  file,
  reader,
  cols = NULL,
  sheet = NULL,
  sheet_pattern = NULL,
  ...
)
}
\arguments{
\item{file}{Character string. Path to the file to be read.}

\item{reader}{Function used to read the file (e.g., \code{readr::read_csv},
\code{readxl::read_excel}). The function must take \code{file} as its first argument.}

\item{cols}{Optional character vector of column names to enforce in the
output. Missing columns will be added and filled with \code{NA}, and extra
columns will be dropped.}

\item{sheet}{The sheet to be selected if static name.}

\item{sheet_pattern}{Optional regex pattern to select the sheet by name.}

\item{...}{Additional arguments passed directly to \code{reader()}.}
}
\value{
A named list with the following elements:
\describe{
\item{data}{A tibble containing the imported data, or \code{NULL} if an error occurred.}
\item{error}{\code{NULL} if the file was read successfully; otherwise, a character
string containing the error message.}
\item{file}{The input file path.}
}
}
\description{
Reads a data file using a user-supplied reader function, returning a tibble
along with any error message encountered during import. This is useful when
batch-reading many files where some may be malformed or inconsistent.
}
\examples{
\dontrun{
files <- c("data/a.csv", "data/b.csv")

results <- lapply(
  files,
  safe_read_data,
  reader = readr::read_csv,
  cols = c("id", "value", "date")
)

# Extract successfully read data
good_data <- purrr::keep(results, ~ is.null(.x$error))
}

}
